// Datastar v1.0.0-RC.7
var ft=/ðŸ–•JS_DSðŸš€/.source,ve=ft.slice(0,5),te=ft.slice(4),V="datastar",dt="Datastar-Request",mt=1e3,gt="type module",yt=!1,bt=!1,ht=!0,Oe="morph",St="inner",vt="outer",Et="prepend",Tt="append",xt="before",At="after",wt="upsertAttributes",Mt=Oe,He="datastar-merge-fragments",$e="datastar-merge-signals",Ge="datastar-remove-fragments",We="datastar-remove-signals",qe="datastar-execute-script";var B=e=>e.trim()==="true",K=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([a-z])([0-9]+)/gi,"$1-$2").replace(/([0-9]+)([a-z])/gi,"$1-$2").toLowerCase(),fe=e=>K(e).replace(/-./g,t=>t[1].toUpperCase()),de=e=>K(e).replace(/-/g,"_"),Vn=e=>fe(e).replace(/^./,t=>t[0].toUpperCase()),Rt=e=>Function(`return Object.assign({}, ${e})`)(),z=e=>e.startsWith("$")?e.slice(1):e,In={kebab:K,snake:de,pascal:Vn};function F(e,t){for(let n of t.get("case")||[]){let r=In[n];r&&(e=r(e))}return e}var On="computed",Dt={type:"attribute",name:On,keyReq:"must",valReq:"must",isExpr:!0,onLoad:({key:e,mods:t,genRX:n,computed:r,batch:i})=>{e=F(e,t);let{deps:a,rxFn:o}=n();i(()=>{r(a,o,e)})}};var q=`${V}-signal-change`;var xe=new Set,Ae=new Set,we=new Set;function Me(e){xe.clear(),Ae.clear(),we.clear();let t=e();return(xe.size||Ae.size||we.size)&&document.dispatchEvent(new CustomEvent(q,{detail:{added:[...xe],removed:[...Ae],updated:[...we]}})),t}var I=[],X=new Map;function re(){return I}function ze(e){return X.get(e)}function Hn(e){let t=[],n=0,r=I.length-1,i=a=>a!==e&&!a.startsWith(`${e}.`);for(;n<=r;){let a=Math.floor((n+r)/2),o=I[a];if(o<e)n=a+1;else if(o>e)r=a-1;else{let s=a;do{let c=I[s];if(i(c))break;s--}while(s>=0);let l=a;do{let c=I[l];if(i(c))break;l++}while(l<I.length);for(let c=s+1;c<l;c++)t.push(I[c]);return t}}return t}function Ct(e,t){Xe(e),I.push(e),X.set(e,t),I.sort((n,r)=>r.length-n.length),xe.add(e)}function $(e,t){let n=X.get(e);if(n){if(!(n instanceof ne))return;n.value=t}else ye(t,e)}function ie(e){return X.get(e)?.value}function se(e,t){let n=!1,r=X.get(e);return r||(n=!0,r=ye(t,e)),{dep:r,inserted:n}}function Re(e,t=!1){let n=Lt(e);for(let[r,i]of Object.entries(n))X.has(r)&&t||$(r,i)}function Xe(...e){for(let t of e){let n=Hn(t);for(let r of n){X.delete(r);let i=I.indexOf(r);i>-1&&I.splice(i,1),Ae?.add(r)}}}function De(e=!0,t=!1){return JSON.stringify($n(t),null,e?2:0)}function $n(e,...t){let n=new Map;for(let i of I)if(!(e&&i.match(/^_|\._/))){if(t.length>0){let a=!1;for(let o of t)if(i.startsWith(o)){a=!0;break}if(!a)continue}n.set(i,X.get(i)?.value)}return Wn(n)}function Gn(e){return Object.prototype.toString.call(e)==="[object Object]"}function Lt(e,t=[],n="."){return Object.keys(e).reduce((r,i)=>Object.assign({},r,Gn(e[i])?Lt(e[i],t.concat([i]),n):{[t.concat([i]).join(n)]:e[i]}),{})}function Wn(e,t="."){let n={};for(let[r,i]of e.entries()){let a=r.split(t),o=n;for(let s=0;s<a.length-1;s++){let l=a[s];o[l]||(o[l]={}),o=o[l]}o[a[a.length-1]]=i}return n}function Pt(e,t,n,...r){return Me(()=>e(...r,...n.map((i,a)=>t[a]?i:i.value)))}var Ee=[],me=[],Te=0,ge=0;function Je(e,t){switch(e.length){case 0:return t;case 1:return()=>t(e[0].value);case 2:return()=>t(e[0].value,e[1].value);case 3:return()=>t(e[0].value,e[1].value,e[2].value);case 4:return()=>t(e[0].value,e[1].value,e[2].value,e[3].value)}let n=e.length;return Ee[n]||(Ee[n]=Array(n)),()=>{for(let r=0;r<n;r++)Ee[n][r]=e[r].value;return t(...Ee[n])}}function _e(e){e.flags&=-249;let t=e.currentValue,n=e.getter();return t!==n?(e.currentValue=n,!0):!1}function qn(e){let t=e.flags;return(t&32||t&64&&_n(e,t))&&(e.flags&=-249,e.run()),!0}function _n(e,t){return kt(e.deps)?(e.flags=t|32,!0):(e.flags=t&-65,!1)}function ye(e,t){return new ne(e,t)}var ne=class{constructor(t,n){this.currentValue=t;this.path=n;n&&Ct(n,this)}get value(){return this.currentValue}set value(t){if(this.currentValue!==t&&(this.currentValue=t,this.path&&we.add(this.path),this.subs)){let n=this.subs,r=n.nextSub,i,a=0,o=32;e:do{let s=n.sub,l=s.flags,c=!1;if(l&244?l&16&&!(l&4)?(s.flags=l&-17|o|8,c=!0):!(l&224)&&Be(n,s)&&(s.flags=l|16|o|8,c=!!s.subs):(s.flags=l|o|8,c=!0),c){let u=s.subs;if(u){n=u,u.nextSub?(i={target:r,linked:i},++a,r=n.nextSub,o=64):o=l&2?128:64;continue}l&2&&(me[ge++]=s)}else l&(4|o)?!(l&o)&&l&224&&Be(n,s)&&(s.flags=l|o):(s.flags=l|o|8,(l&10)===2&&(me[ge++]=s));if(n=r){r=n.nextSub,o=a?64:32;continue}for(;a--;)if(n=i.target,i=i.linked,n){r=n.nextSub,o=a?64:32;continue e}break}while(!0);for(;Te<ge;){let s=me[Te];me[Te++]=void 0,qn(s)||(s.flags&=-9)}Te=0,ge=0}}};function Qe(e,t,n){return new je(e,Je(e,t),n)}var je=class{constructor(t,n,r){this.path=r;this.flags=33;this.getter=Je(t,n),r&&Ct(r,this);for(let i of t)Ft(i,this)}get value(){let t=this.flags;if(t&96)if(t&32||kt(this.deps)){if(_e(this)){let n=this.subs;n&&Ke(n)}}else this.flags=t&-65;return this.currentValue}};function Ye(e,t){let n=new Ue(e,t);return()=>n.dispose()}var Ue=class{constructor(t,n){this.flags=2;for(let r of t)Ft(r,this);this.run=Je(t,n),this.run()}dispose(){if(this.depsTail=void 0,this.flags&=-249,this.deps){let t=this.deps;do{let n=t.dep,r=t.nextDep,i=t.nextSub,a=t.prevSub;if(i?i.prevSub=a:n.subsTail=a,a?a.nextSub=i:n.subs=i,!n.subs&&"deps"in n){let o=n.flags;o&32||(n.flags=o|32);let s=n.deps;if(s){t=s,n.depsTail.nextDep=r,n.deps=void 0,n.depsTail=void 0;continue}}t=r}while(t);this.deps=void 0}}};function Ft(e,t){let n=t.depsTail;if(n&&n.dep===e)return;let r=n?n.nextDep:t.deps;if(r&&r.dep===e){t.depsTail=r;return}let i=e.subsTail;if(i&&i.sub===t&&Be(i,t))return;let a={dep:e,sub:t,nextDep:r,prevSub:void 0,nextSub:void 0};if(n?n.nextDep=a:t.deps=a,!e.subs)e.subs=a;else{let o=e.subsTail;a.prevSub=o,o.nextSub=a}return t.depsTail=a,e.subsTail=a,a}function kt(e){let t,n=0,r;e:do{r=!1;let i=e.dep;if(e.sub.flags&32)r=!0;else if("flags"in i){let a=i.flags;if((a&33)===33){if(_e(i)){let o=i.subs;o.nextSub&&Ke(o),r=!0}}else if((a&65)===65){(e.nextSub||e.prevSub)&&(t={target:e,linked:t}),e=i.deps,++n;continue}}if(!r&&e.nextDep){e=e.nextDep;continue}for(;n;){--n;let a=e.sub,o=a.subs;if(r){if(_e(a)){o.nextSub?(e=t.target,t=t.linked,Ke(o)):e=o;continue}}else a.flags&=-65;if(o.nextSub?(e=t.target,t=t.linked):e=o,e.nextDep){e=e.nextDep;continue e}r=!1}return r}while(!0)}function Ke(e){do{let t=e.sub,n=t.flags;(n&96)===64&&(t.flags=n|32|8,(n&10)===2&&(me[ge++]=t)),e=e.nextSub}while(e)}function Be(e,t){let n=t.depsTail;if(n){let r=t.deps;do{if(r===e)return!0;if(r===n)break;r=r.nextDep}while(r)}return!1}var Nt={type:"attribute",name:"signals",isExpr:!0,onLoad:e=>{let{key:t,mods:n,value:r,genRX:i,evalRX:a,batch:o}=e,{deps:s,dm:l,rxFn:c}=i(),u=n.has("ifmissing");if(t!==""){let p=F(t,n),m=r===""?r:a(c,l,s);o(()=>{u?se(p,m):$(p,m)})}else{let p=a(c,l,s);o(()=>{Re(p,u)})}}};function Ce(e){return e instanceof HTMLElement||e instanceof SVGElement}function oe(e,t){let n=J?`data-${J}-ignore`:"data-ignore",r=`${n}__self`;if(!Ce(e)||e.closest(`[${n}]`))return;let i=document.createTreeWalker(e,1);for(;e;){if(Ce(e)){if(e.hasAttribute(n)){e=i.nextSibling();continue}e.hasAttribute(r)||t(e)}e=i.nextNode()}}var jn="https://data-star.dev/errors";function Vt(e,t,n={}){let r=new Error;r.name=`${V} ${e} error`;let i=de(t),a=new URLSearchParams({metadata:JSON.stringify(n)}).toString(),o=JSON.stringify(n,null,2);return r.message=`${t}
More info: ${jn}/${e}/${i}?${a}
Context: ${o}`,r}function O(e,t,n={}){let r={plugin:{name:t.plugin.name,type:t.plugin.type}};return Vt("init",e,Object.assign(r,n))}function h(e,t,n={}){let r={plugin:{name:t.plugin.name,type:t.plugin.type},element:{id:t.el.id,tag:t.el.tagName},expression:{rawKey:t.rawKey,key:t.key,value:t.value,validSignals:re(),fnContent:t.fnContent}};return Vt("runtime",e,Object.assign(r,n))}var be={},et=[],ae=new Map,Ze=null,J="";function It(e){J=e}function Le(...e){for(let t of e){let n={plugin:t,actions:be,removals:ae,applyToElement:Pe,batch:Me,signal:ye,computed:Qe,effect:Ye},r=t.type;if(r==="action")be[t.name]=t;else if(r==="attribute")et.push(t),t.onGlobalInit?.(n);else if(r==="watcher")t.onGlobalInit?.(n);else throw O("InvalidPluginType",n)}et.sort((t,n)=>{let r=n.name.length-t.name.length;return r!==0?r:t.name.localeCompare(n.name)})}function tt(){queueMicrotask(()=>{oe(document.documentElement,Pe),Ze||(Ze=new MutationObserver(Un),Ze.observe(document.body,{subtree:!0,childList:!0,attributes:!0}))})}function Un(e){let t=new Set;for(let{target:r,type:i,addedNodes:a,removedNodes:o}of e)switch(i){case"childList":{for(let s of o)oe(s,l=>{let c=ae.get(l);if(ae.delete(l)){for(let u of c.values())u();c.clear()}});for(let s of a)oe(s,l=>t.add(l))}break;case"attributes":{if(!Ce(r)||r.closest(`[${J?`data-${J}-ignore`:"data-ignore"}]`))continue;t.add(r);break}}let n=Array.from(t);n.sort((r,i)=>r.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1);for(let r of n)Pe(r)}function Ot(e){let t=5831,n=e.length;for(;n--;)t+=(t<<5)+e.charCodeAt(n);return(t>>>0).toString(36)}function Pe(e){let t=[],n=ae.get(e)||new Map,r=new Map(n);for(let[i,a]of Object.entries(e.dataset)){if(!i.startsWith(J))continue;let o=Ot(`${i}${a}`);r.delete(o)||t.push({key:i,value:a,hash:o})}for(let[i,a]of r)a(),n.delete(i);for(let{key:i,value:a,hash:o}of t){let s=Kn(e,i,a);s&&n.set(o,s)}n.size&&ae.set(e,n)}function Kn(e,t,n){let r=fe(t.slice(J.length)),i=et.find(m=>RegExp(`^${m.name}([A-Z]|_|$)`).test(r));if(!i)return;let[a,...o]=r.slice(i.name.length).split(/\_\_+/),s=!!a;s&&(a=fe(a));let l=!!n,c={applyToElement:Pe,actions:be,removals:ae,genRX:()=>Bn(c,...i.argNames||[]),plugin:i,el:e,rawKey:r,key:a,value:n,mods:new Map,batch:Me,signal:ye,computed:Qe,effect:Ye,evalRX:Pt},u=i.keyReq||"allowed";if(s){if(u==="denied")throw h(`${i.name}KeyNotAllowed`,c)}else if(u==="must")throw h(`${i.name}KeyRequired`,c);let p=i.valReq||"allowed";if(l){if(p==="denied")throw h(`${i.name}ValueNotAllowed`,c)}else if(p==="must")throw h(`${i.name}ValueRequired`,c);if(u==="exclusive"||p==="exclusive"){if(s&&l)throw h(`${i.name}KeyAndValueProvided`,c);if(!s&&!l)throw h(`${i.name}KeyOrValueRequired`,c)}for(let m of o){let[y,...f]=m.split(".");c.mods.set(fe(y),new Set(f.map(g=>g.toLowerCase())))}return i.onLoad(c)||(()=>{})}function Bn(e,...t){let n=[],r=new Set,i="";if(e.plugin.isExpr){let f=/(\/(\\\/|[^\/])*\/|"(\\"|[^\"])*"|'(\\'|[^'])*'|`(\\`|[^`])*`|\(\s*((function)\s*\(\s*\)|(\(\s*\))\s*=>)\s*(?:\{[\s\S]*?\}|[^;)\{]*)\s*\)\s*\(\s*\)|[^;])+/gm,g=e.value.trim().match(f);if(g){let S=g.length-1,A=g[S].trim();A.startsWith("return")||(g[S]=`return (${A});`),i=g.join(`;
`)}}else i=e.value.trim();let a=new Map,o=RegExp(`(?:${ve})(.*?)(?:${te})`,"gm");for(let f of i.matchAll(o)){let g=f[1],S=`dsEscaped${Ot(g)}`;a.set(S,g),i=i.replace(ve+g+te,S)}let s=(f,g)=>`${f}${de(g).replaceAll(/\./g,"_")}`,l=new Set(t),c=re();if(c.length){let f=c.join("|"),g=RegExp(`\\$(${f})(\\s*[+&^\\/*|-]?=[^=]|\\+\\+|--)`,"gm"),S=[...i.matchAll(g)],A=(N,v,T="")=>{let k=RegExp(`\\$${N[1]}(?!\\w)`,"gm");i=i.replaceAll(k,v+T)};if(S.length){let N=`${V}Mut_`,v=new Set;for(let T of S){let k=T[1],d=ze(k),x=s(N,k);d&&!v.has(d)&&(r.add(d),v.add(d),n.push(!0),l.add(x)),A(T,x,".value")}}let w=RegExp(`\\$(${f})(\\W|$)`,"gm"),R=[...i.matchAll(w)];if(R.length){let N=`${V}Pure_`,v=new Set;for(let T of R){let k=T[1],d=ze(k),x=s(N,k);d&&!v.has(d)&&(r.add(d),v.add(d),n.push(!1),l.add(x)),A(T,x)}}}let u=new Set,p=RegExp(`@(${Object.keys(be).join("|")})\\(`,"gm"),m=[...i.matchAll(p)],y=new Set;if(m.length){let f=`${V}Act_`;for(let g of m){let S=g[1],A=be[S];if(!A)continue;u.add(S);let w=s(f,S);l.add(w),i=i.replace(`@${S}(`,`${w}(`),y.add((...R)=>A.fn(e,...R))}}for(let[f,g]of a)i=i.replace(f,g);e.fnContent=i;try{let f=Function("el",...l,i);return{dm:n,deps:[...r],rxFn:(...g)=>{try{return f(e.el,...g,...y)}catch(S){throw h("ExecuteExpression",e,{error:S.message})}}}}catch(f){throw h("GenerateExpression",e,{error:f.message})}}Le(Nt,Dt);var Q=`${V}-sse`,Fe="started",ke="finished",Ht="error",$t="retrying",Gt="retrying";function _(e,t){document.addEventListener(Q,n=>{if(n.detail.type!==e)return;let{argsRaw:r}=n.detail;t(r)})}function le(e,t,n){document.dispatchEvent(new CustomEvent(Q,{detail:{type:e,el:t,argsRaw:n}}))}var Wt=e=>`${e}`.includes("text/event-stream"),qt=e=>e==="GET",j=async(e,t,n,r)=>{let{el:i,evt:a}=e,{headers:o,contentType:s,includeLocal:l,excludeSignals:c,selector:u,openWhenHidden:p,retryInterval:m,retryScaler:y,retryMaxWaitMs:f,retryMaxCount:g,abort:S}=Object.assign({headers:{},contentType:"json",includeLocal:!1,excludeSignals:!1,selector:null,openWhenHidden:!1,retryInterval:mt,retryScaler:2,retryMaxWaitMs:3e4,retryMaxCount:10,abort:void 0},r),A=t.toLowerCase(),w=()=>{};try{if(!n?.length)throw h("SseNoUrlProvided",e,{action:A});let R={};R[dt]=!0,s==="json"&&(R["Content-Type"]="application/json");let N=Object.assign({},R,o),v={method:t,headers:N,openWhenHidden:p,retryInterval:m,retryScaler:y,retryMaxWaitMs:f,retryMaxCount:g,signal:S,onopen:async d=>{if(d.status>=400){let x=d.status.toString();le(Ht,i,{status:x})}},onmessage:d=>{if(!d.event.startsWith(V))return;let x=d.event,D={},L=d.data.split(`
`);for(let E of L){let C=E.indexOf(" "),P=E.slice(0,C),M=D[P];M||(M=[],D[P]=M);let G=E.slice(C+1);M.push(G)}let b={};for(let[E,C]of Object.entries(D))b[E]=C.join(`
`);le(x,i,b)},onerror:d=>{if(Wt(d))throw h("InvalidContentType",e,{url:n});d&&(console.error(d.message),le($t,i,{message:d.message}))}},T=new URL(n,window.location.href),k=new URLSearchParams(T.search);if(s==="json"){if(!c){let d=De(!1,!l);qt(t)?k.set(V,d):v.body=d}}else if(s==="form"){let d=u?document.querySelector(u):i.closest("form");if(d===null)throw u?h("SseFormNotFound",e,{action:A,selector:u}):h("SseClosestFormNotFound",e,{action:A});if(!d.checkValidity()){d.reportValidity(),w();return}let x=new FormData(d),D=i;if(i===d)a instanceof SubmitEvent&&(D=a.submitter);else{let E=C=>C.preventDefault();d.addEventListener("submit",E),w=()=>d.removeEventListener("submit",E)}if(D instanceof HTMLButtonElement){let E=D.getAttribute("name");E&&x.append(E,D.value)}let L=d.getAttribute("enctype")==="multipart/form-data";L||(N["Content-Type"]="application/x-www-form-urlencoded");let b=new URLSearchParams(x);if(qt(t))for(let[E,C]of b)k.append(E,C);else L?v.body=x:v.body=b}else throw h("SseInvalidContentType",e,{action:A,contentType:s});le(Fe,i,{}),T.search=k.toString();try{await Zn(T.toString(),i,v)}catch(d){if(!Wt(d))throw h("SseFetchFailed",e,{method:t,url:n,error:d})}}finally{le(ke,i,{}),w()}};async function zn(e,t){let n=e.getReader(),r;for(r=await n.read();!r.done;)t(r.value),r=await n.read()}function Xn(e){let t,n,r,i=!1;return function(o){t===void 0?(t=o,n=0,r=-1):t=Qn(t,o);let s=t.length,l=0;for(;n<s;){i&&(t[n]===10&&(l=++n),i=!1);let c=-1;for(;n<s&&c===-1;++n)switch(t[n]){case 58:r===-1&&(r=n-l);break;case 13:i=!0;case 10:c=n;break}if(c===-1)break;e(t.subarray(l,c),r),l=n,r=-1}l===s?t=void 0:l!==0&&(t=t.subarray(l),n-=l)}}function Jn(e,t,n){let r=_t(),i=new TextDecoder;return function(o,s){if(o.length===0)n?.(r),r=_t();else if(s>0){let l=i.decode(o.subarray(0,s)),c=s+(o[s+1]===32?2:1),u=i.decode(o.subarray(c));switch(l){case"data":r.data=r.data?`${r.data}
${u}`:u;break;case"event":r.event=u;break;case"id":e(r.id=u);break;case"retry":{let p=Number.parseInt(u,10);Number.isNaN(p)||t(r.retry=p);break}}}}}function Qn(e,t){let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function _t(){return{data:"",event:"",id:"",retry:void 0}}var Yn="text/event-stream",jt="last-event-id";function Zn(e,t,{signal:n,headers:r,onopen:i,onmessage:a,onclose:o,onerror:s,openWhenHidden:l,fetch:c,retryInterval:u=1e3,retryScaler:p=2,retryMaxWaitMs:m=3e4,retryMaxCount:y=10,...f}){return new Promise((g,S)=>{let A=0,w={...r};w.accept||(w.accept=Yn);let R;function N(){R.abort(),document.hidden||x()}l||document.addEventListener("visibilitychange",N);let v=0;function T(){document.removeEventListener("visibilitychange",N),window.clearTimeout(v),R.abort()}n?.addEventListener("abort",()=>{T(),g()});let k=c??window.fetch,d=i??function(){};async function x(){R=new AbortController;try{let D=await k(e,{...f,headers:w,signal:R.signal});await d(D),await zn(D.body,Xn(Jn(L=>{L?w[jt]=L:delete w[jt]},L=>{u=L},a))),o?.(),T(),g()}catch(D){if(!R.signal.aborted)try{let L=s?.(D)??u;window.clearTimeout(v),v=window.setTimeout(x,L),u*=p,u=Math.min(u,m),A++,A>=y?(le(Gt,t,{}),T(),S("Max retries reached.")):console.error(`Datastar failed to reach ${e.toString()} retrying in ${L}ms.`)}catch(L){T(),S(L)}}}x()})}var Ut={type:"action",name:"delete",fn:async(e,t,n)=>j(e,"DELETE",t,{...n})};var Kt={type:"action",name:"get",fn:async(e,t,n)=>j(e,"GET",t,{...n})};var Bt={type:"action",name:"patch",fn:async(e,t,n)=>j(e,"PATCH",t,{...n})};var zt={type:"action",name:"post",fn:async(e,t,n)=>j(e,"POST",t,{...n})};var Xt={type:"action",name:"put",fn:async(e,t,n)=>j(e,"PUT",t,{...n})};var Jt={type:"watcher",name:qe,onGlobalInit:async e=>{_(qe,({autoRemove:t=`${ht}`,attributes:n=gt,script:r})=>{let i=B(t);if(!r?.length)throw O("NoScriptProvided",e);let a=document.createElement("script");for(let o of n.split(`
`)){let s=o.indexOf(" "),l=s?o.slice(0,s):o,c=s?o.slice(s):"";a.setAttribute(l.trim(),c.trim())}a.text=r,document.head.appendChild(a),i&&a.remove()})}};var he=document,Se=!!he.startViewTransition;function U(e,t){if(t.has("viewtransition")&&Se){let n=e;e=(...r)=>document.startViewTransition(()=>n(...r))}return e}var an="div",nt="value",st=e=>document.createElement(e),ln=()=>st(an),er=e=>`<${e}></${e}>`,Qt=e=>[...e.querySelectorAll("[id]")],cn=e=>e instanceof Element,Yt=e=>e instanceof HTMLTemplateElement,Zt=e=>e instanceof HTMLInputElement,en=e=>e instanceof HTMLTextAreaElement,tn=e=>e instanceof HTMLOptionElement,un={type:"watcher",name:He,onGlobalInit:async e=>{let t=st("template");_(He,({fragments:n=er(an),selector:r="",mergeMode:i=Mt,useViewTransition:a="false"})=>{let o=B(a);t.innerHTML=n.trim();for(let s of[...t.content.children]){if(!cn(s))throw O("NoFragmentsFound",e);let l=r||`#${s.getAttribute("id")}`,c=document.querySelectorAll(l);if(!c.length)throw O("NoTargetsFound",e,{selectorOrID:l});o&&Se?he.startViewTransition(()=>nn(e,i,s,c)):nn(e,i,s,c)}})}};function nn(e,t,n,r){for(let i of r){let a=n.cloneNode(!0);switch(t){case Oe:{nr(i,a),oe(i,o=>{let s=e.removals.get(o);if(e.removals.delete(o)){for(let l of s.values())l();s.clear()}e.applyToElement(o)});break}case St:i.innerHTML=a.outerHTML;break;case vt:i.replaceWith(a);break;case Et:i.prepend(a);break;case Tt:i.append(a);break;case xt:i.before(a);break;case At:i.after(a);break;case wt:for(let o of a.getAttributeNames()){let s=a.getAttribute(o);i.setAttribute(o,s)}break;default:throw O("InvalidMergeMode",e,{mergeMode:t})}}}var ue=ln();ue.hidden=!0;var Ne,H=new Map,ce=new Set,tr=ue.moveBefore!==void 0;function nr(e,t){let n=ln();n.append(t);let r=Qt(n),i=Qt(e);e.id&&i.push(e);let a=new Set,o=new Map;for(let{id:m,tagName:y}of i)o.has(m)?a.add(m):o.set(m,y);ce.clear();for(let{id:m,tagName:y}of r)ce.has(m)?a.add(m):o.get(m)===y&&ce.add(m);for(let m of a)ce.delete(m);H.clear(),on(e.parentElement,i),on(n,r),document.body.insertAdjacentElement("afterend",ue),Ne=e;let s=e.parentNode,l=e.previousSibling,c=e.nextSibling;pn(s,n,e,c);let u=[],p=l?.nextSibling||s.firstChild;for(;p&&p!==c;)u.push(p),p=p.nextSibling;return ue.remove(),u}function pn(e,t,n=null,r=null){Yt(e)&&Yt(t)&&(e=e.content,t=t.content),n??=e.firstChild;for(let i of t.childNodes){if(n&&n!==r){let o=rr(i,n,r);if(o){if(o!==n){let s=n;for(;s&&s!==o;){let l=s;s=s.nextSibling,sn(l)}}rt(o,i),n=o.nextSibling;continue}}if(cn(i)&&ce.has(i.id)){let o=i.id,s=`[id="${o}"]`,l=p=>p.querySelector(s),c=Ne.id===o&&Ne||l(Ne)||l(ue),u=c;for(;u=u.parentNode;){let p=H.get(u);p&&(p.delete(c.id),p.size||H.delete(u))}fn(e,c,n),rt(c,i),n=c.nextSibling;continue}if(H.has(i)){let o=st(i.tagName);return e.insertBefore(o,n),rt(o,i),o}let a=document.importNode(i,!0);e.insertBefore(a,n)}for(;n&&n!==r;){let i=n;n=n.nextSibling,sn(i)}}function rr(e,t,n){let r=null,i=e.nextSibling,a=0,o=0,s=H.get(e)?.size||0,l=t;for(;l&&l!==n;){if(rn(l,e)){let c=!1,u=H.get(l),p=H.get(e);if(p&&u){for(let m of u)if(p.has(m)){c=!0;break}}if(c)return l;if(!r&&!H.has(l)){if(!s)return l;r=l}}if(o+=H.get(l)?.size||0,o>s||(r===null&&i&&rn(l,i)&&(a++,i=i.nextSibling,a>=2&&(r=void 0)),l.contains(document.activeElement)))break;l=l.nextSibling}return r||null}function rn(e,t){let n=e,r=t;return n.nodeType===r.nodeType&&n.tagName===r.tagName&&(!n.id||n.id===r.id)}function sn(e){H.has(e)?fn(ue,e,null):e.parentNode?.removeChild(e)}function fn(e,t,n=null){tr?e.moveBefore(t,n):e.insertBefore(t,n)}function rt(e,t){let n=t.nodeType,r=e,i=t;if(n===1){let a=r.attributes,o=i.attributes;for(let s of o)r.getAttribute(s.name)!==s.value&&r.setAttribute(s.name,s.value);for(let s=a.length-1;0<=s;s--){let l=a[s];l&&(i.hasAttribute(l.name)||r.removeAttribute(l.name))}if(Zt(r)&&Zt(i)&&i.type!=="file"){let s=i.value,l=r.value;it(r,i,"checked"),it(r,i,"disabled"),Object.keys(i.dataset||{}).some(u=>u.startsWith("bind"))||(i.hasAttribute(nt)?l!==s&&(r.setAttribute(nt,s),r.value=s):(r.value="",r.removeAttribute(nt)))}else if(tn(r)&&tn(i))it(r,i,"selected");else if(en(r)&&en(i)){let s=i.value,l=r.value;s!==l&&(r.value=s),r.firstChild&&r.firstChild.nodeValue!==s&&(r.firstChild.nodeValue=s)}}return(n===8||n===3)&&e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),r.innerHTML!==i.innerHTML&&pn(r,i),e}function it(e,t,n){let r=t,i=e,a=r[n],o=i[n];a!==o&&(i[n]=r[n],a?e.setAttribute(n,""):e.removeAttribute(n))}function on(e,t){for(let n of t)if(ce.has(n.id)){let r=n;for(;r&&r!==e;){let i=H.get(r);i||(i=new Set,H.set(r,i)),i.add(n.id),r=r.parentElement}}}var dn={type:"watcher",name:$e,onGlobalInit:async({batch:e})=>{_($e,({signals:t="{}",onlyIfMissing:n=`${bt}`})=>{let r=B(n),i=Rt(t);e(()=>Re(i,r))})}};var mn={type:"watcher",name:Ge,onGlobalInit:async e=>{_(Ge,({selector:t,useViewTransition:n=`${yt}`})=>{if(!t.length)throw O("NoSelectorProvided",e);let r=B(n),i=document.querySelectorAll(t),a=()=>{for(let o of i)o.remove()};r&&Se?he.startViewTransition(()=>a()):a()})}};var gn={type:"watcher",name:We,onGlobalInit:async e=>{let{batch:t}=e;_(We,({paths:n=""})=>{let r=n.split(`
`).map(i=>i.trim());if(!r?.length)throw O("NoPathsProvided",e);t(()=>{Xe(...r)})})}};var yn={type:"attribute",name:"attr",valReq:"must",isExpr:!0,onLoad:({el:e,key:t,genRX:n,computed:r,effect:i})=>{let{deps:a,rxFn:o}=n(),s=(c,u)=>{u===""||u===!0?e.setAttribute(c,""):u===!1||u===null||u===void 0?e.removeAttribute(c):e.setAttribute(c,u)};if(t===""){let c=r(a,o);return i([c],u=>{for(let[p,m]of Object.entries(u))s(p,m)})}t=K(t);let l=r(a,o);return i([l],c=>{s(t,c)})}};var ir=/^data:(?<mime>[^;]+);base64,(?<contents>.*)$/,bn=["change","input","keydown"],hn={type:"attribute",name:"bind",keyReq:"exclusive",valReq:"exclusive",onLoad:e=>{let{el:t,key:n,mods:r,value:i,effect:a,batch:o}=e,s=t,l=n?F(n,r):z(i),c=t.tagName.toLowerCase(),u=c.includes("input"),p=c.includes("select"),m=t.getAttribute("type"),y=t.hasAttribute("value"),f="",g=u&&m==="checkbox";g&&(s.hasAttribute("checked")?f=y?s.value:!0:f=y?"":!1);let S=u&&m==="number";S&&(f=0);let A=u&&m==="radio";A&&(t.getAttribute("name")?.length||t.setAttribute("name",l));let w=u&&m==="file",{dep:R,inserted:N}=o(()=>se(l,f)),v=-1;Array.isArray(R.value)&&(t.getAttribute("name")===null&&t.setAttribute("name",l),v=[...document.querySelectorAll(`[name="${l}"]`)].findIndex(b=>b===e.el));let T=v>=0,k=()=>[...ie(l)],d=()=>{let b=ie(l);T&&!p&&(b=b[v]||f);let E=`${b}`;if(g||A)typeof b=="boolean"?s.checked=b:s.checked=E===s.value;else if(p){let C=t;if(C.multiple){if(!T)throw h("BindSelectMultiple",e);for(let P of C.options){if(P?.disabled)continue;let M=S?Number(P.value):P.value;P.selected=b.includes(M)}}else C.value=E}else w||("value"in t?t.value=E:t.setAttribute("value",E))},x=async()=>{let b=ie(l);if(T){let M=b;for(;v>=M.length;)M.push(f);b=M[v]||f}let E=(M,G)=>{let W=G;T&&!p&&!w&&(W=k(),W[v]=G),$(M,W)};if(w){let M=[...s?.files||[]],G=[],W=[],ut=[];await Promise.all(M.map(pt=>new Promise(Nn=>{let Z=new FileReader;Z.onload=()=>{if(typeof Z.result!="string")throw h("InvalidFileResultType",e,{resultType:typeof Z.result});let Ie=Z.result.match(ir);if(!Ie?.groups)throw h("InvalidDataUri",e,{result:Z.result});G.push(Ie.groups.contents),W.push(Ie.groups.mime),ut.push(pt.name)},Z.onloadend=()=>Nn(void 0),Z.readAsDataURL(pt)}))),o(()=>{E(l,G),E(`${l}Mimes`,W),E(`${l}Names`,ut)});return}let C=s.value||"",P;if(g){let M=s.checked;y?P=M?C:"":P=M}else if(p){let G=[...t.selectedOptions];T?P=G.filter(W=>W.selected).map(W=>W.value):P=G[0]?.value||f}else typeof b=="boolean"?P=!!C:typeof b=="number"?P=Number(C):P=C||"";o(()=>{E(l,P)})};N&&x();for(let b of bn)t.addEventListener(b,x);let D=b=>{b.persisted&&x()};window.addEventListener("pageshow",D);let L=a([R],()=>d());return()=>{L();for(let b of bn)t.removeEventListener(b,x);window.removeEventListener("pageshow",D)}}};var Sn={type:"attribute",name:"class",valReq:"must",isExpr:!0,onLoad:({el:e,key:t,mods:n,genRX:r,computed:i,effect:a})=>{let o=e.classList,{deps:s,rxFn:l}=r(),c=i(s,l);return a([c],u=>{if(t===""){let p=u;for(let[m,y]of Object.entries(p)){let f=m.split(/\s+/);y?o.add(...f):o.remove(...f)}}else{let p=K(t);p=F(p,n),u?o.add(p):o.remove(p)}})}};var vn={type:"attribute",name:"indicator",keyReq:"exclusive",valReq:"exclusive",onLoad:e=>{let{el:t,key:n,mods:r,value:i,batch:a}=e,o=n?F(n,r):z(i),{dep:s}=a(()=>se(o,!1));if(!(s instanceof ne))throw h("not_signal",e,{signalName:o});let l=c=>{let{type:u,el:p}=c.detail;if(p===t)switch(u){case Fe:s.value=!0;break;case ke:s.value=!1;break}};return document.addEventListener(Q,l),()=>{s.value=!1,document.removeEventListener(Q,l)}}};var En={type:"attribute",name:"jsonSignals",keyReq:"denied",valReq:"denied",onLoad:e=>{let{el:t}=e;t instanceof HTMLElement||h("JsonSignalsInvalidElement",e);let n=()=>{t.textContent=De(!0)};return n(),document.addEventListener(q,n),()=>{document.removeEventListener(q,n)}}};function Y(e){if(!e||e.size<=0)return 0;for(let t of e){if(t.endsWith("ms"))return Number(t.replace("ms",""));if(t.endsWith("s"))return Number(t.replace("s",""))*1e3;try{return Number.parseFloat(t)}catch{}}return 0}function ee(e,t,n=!1){return e?e.has(t.toLowerCase()):n}function ot(e,t){return(...n)=>{setTimeout(()=>{e(...n)},t)}}function sr(e,t,n=!1,r=!0){let i=0,a=()=>i&&clearTimeout(i);return(...o)=>{a(),n&&!i&&e(...o),i=setTimeout(()=>{r&&e(...o),a()},t)}}function or(e,t,n=!0,r=!1){let i=!1;return(...a)=>{i||(n&&e(...a),i=!0,setTimeout(()=>{i=!1,r&&e(...a)},t))}}function pe(e,t){let n=t.get("delay");if(n){let a=Y(n);e=ot(e,a)}let r=t.get("debounce");if(r){let a=Y(r),o=ee(r,"leading",!1),s=!ee(r,"notrail",!1);e=sr(e,a,o,s)}let i=t.get("throttle");if(i){let a=Y(i),o=!ee(i,"noleading",!1),s=ee(i,"trail",!1);e=or(e,a,o,s)}return e}var Tn={type:"attribute",name:"on",keyReq:"must",valReq:"must",argNames:["evt"],onLoad:e=>{let{el:t,key:n,mods:r,genRX:i,evalRX:a}=e,o=t;r.has("window")&&(o=window);let{dm:s,deps:l,rxFn:c}=i(),u=f=>{if(f){if(r.has("prevent")&&f.preventDefault(),r.has("stop")&&f.stopPropagation(),!(f.isTrusted||f instanceof CustomEvent||r.has("trust")))return;e.evt=f}a(c,s,l,f)};u=pe(u,r),u=U(u,r);let p={capture:!1,passive:!1,once:!1};if(r.has("capture")&&(p.capture=!0),r.has("passive")&&(p.passive=!0),r.has("once")&&(p.once=!0),r.has("outside")){o=document;let f=u;u=g=>{let S=g?.target;t.contains(S)||f(g)}}let y=K(n);if(y=F(y,r),(y===Q||y===q)&&(o=document),t instanceof HTMLFormElement&&y==="submit"){let f=u;u=g=>{g?.preventDefault(),f(g)}}return o.addEventListener(y,u,p),()=>{o.removeEventListener(y,u)}}};var at=new WeakSet,xn={type:"attribute",name:"onIntersect",keyReq:"denied",onLoad:({el:e,mods:t,genRX:n,evalRX:r})=>{let{dm:i,deps:a,rxFn:o}=n(),s=()=>r(o,i,a);s=pe(s,t),s=U(s,t);let l={threshold:0};t.has("full")?l.threshold=1:t.has("half")&&(l.threshold=.5);let c=new IntersectionObserver(u=>{for(let p of u)p.isIntersecting&&(s(),at.has(e)&&c.disconnect())},l);return c.observe(e),t.has("once")&&at.add(e),()=>{t.has("once")||at.delete(e),c.disconnect()}}};var An={type:"attribute",name:"onInterval",keyReq:"denied",valReq:"must",onLoad:({mods:e,genRX:t,evalRX:n})=>{let{dm:r,deps:i,rxFn:a}=t(),o=()=>n(a,r,i);o=U(o,e);let s=1e3,l=e.get("duration");l&&(s=Y(l),ee(l,"leading",!1)&&o());let c=setInterval(o,s);return()=>{clearInterval(c)}}};var lt=new WeakSet,wn={type:"attribute",name:"onLoad",keyReq:"denied",valReq:"must",onLoad:({el:e,mods:t,genRX:n,evalRX:r})=>{let{dm:i,deps:a,rxFn:o}=n(),s=()=>r(o,i,a);s=U(s,t);let l=0,c=t.get("delay");return c&&(l=Y(c)),s=ot(s,l),lt.has(e)||s(),t.has("once")&&lt.add(e),()=>{t.has("once")||lt.delete(e)}}};function ct(e,t,n=!1){t=t.replaceAll(".","\\.").replaceAll("**",te).replaceAll("*","[^\\.]*").replaceAll(te,".*");let r=RegExp(`^${t}$`).test(e);return n?!r:r}function Ve(e){let t=[],n=e.split(/\s+/).filter(r=>r!=="");n=n.map(r=>z(r));for(let r of n)for(let i of re())ct(i,r)&&t.push(i);return t}var Mn={type:"attribute",name:"onSignalChange",valReq:"must",argNames:["evt"],onLoad:({key:e,mods:t,genRX:n,evalRX:r})=>{let{dm:i,deps:a,rxFn:o}=n(),s=c=>r(o,i,a,c);s=pe(s,t),s=U(s,t);let l=c=>{if(e!==""){let u=!1,p=F(e,t);p.endsWith("!")&&(u=!0,p=p.slice(0,-1));let{added:m,removed:y,updated:f}=c.detail;if(![...m,...y,...f].some(g=>ct(g,p,u)))return}s(c)};return document.addEventListener(q,l),()=>{document.removeEventListener(q,l)}}};var Rn={type:"attribute",name:"ref",keyReq:"exclusive",valReq:"exclusive",onLoad:({el:e,key:t,mods:n,value:r,batch:i})=>{let a=t?F(t,n):z(r);i(()=>{$(a,e)})}};var Dn="none",Cn="display",Ln={type:"attribute",name:"show",keyReq:"denied",valReq:"must",isExpr:!0,onLoad:({el:{style:e},genRX:t,computed:n,effect:r})=>{let{deps:i,rxFn:a}=t(),o=n(i,a);return r([o],async s=>{s?e.display===Dn&&e.removeProperty(Cn):e.setProperty(Cn,Dn)})}};var Pn={type:"attribute",name:"text",keyReq:"denied",valReq:"must",isExpr:!0,onLoad:e=>{let{el:t,genRX:n,computed:r,effect:i}=e,{deps:a,rxFn:o}=n();t instanceof HTMLElement||h("TextInvalidElement",e);let s=r(a,o);return i([s],l=>{t.textContent=`${l}`})}};var Fn={type:"action",name:"setAll",fn:({batch:e},t,n)=>{e(()=>{let r=Ve(t);for(let i of r)$(i,n)})}};var kn={type:"action",name:"toggleAll",fn:({batch:e},t)=>{e(()=>{let n=Ve(t);for(let r of n)$(r,!ie(r))})}};Le(Kt,zt,Xt,Bt,Ut,un,dn,mn,gn,Jt,yn,hn,Sn,vn,En,Tn,xn,An,wn,Mn,Rn,Ln,Pn,Fn,kn);tt();export{tt as apply,Le as load,It as setAlias};
//# sourceMappingURL=datastar.js.map
